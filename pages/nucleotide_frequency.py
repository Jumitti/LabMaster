import streamlit as st
import pandas as pd
import altair as alt
from io import StringIO
from Bio import SeqIO
from utils.page_config import page_config


# Fonction pour calculer les fréquences des nucléotides tous les 5 nucléotides
def calculate_frequencies(sequence, window_size):
    frequencies = []
    for i in range(0, len(sequence), window_size):
        window = sequence[i:i + window_size]
        base_counts = {base: window.count(base) for base in "CGATUN" or base not in "CGATUN"}
        total_bases = len(window)
        for base, count in base_counts.items():
            frequencies.append({
                'position': i,
                'base': base,
                'frequency': count / total_bases if total_bases > 0 else 0
            })
    return pd.DataFrame(frequencies)


# Page config
page_config()

# Configuration de Streamlit
st.title("Visualisation de Séquence en Ruban")
fasta_input = st.text_area("Entrez les séquences au format FASTA",
                           ">NOS2 | Homo sapiens | NC_000017.11 | Promoter | TSS (on chromosome): 27800528 | TSS (on sequence): 3000\n"
                           "CCAGATATGCCGATATGGCATCCTGATTATCTCCAGCTGAAGGCATTTGAGAAAGAGCAGCTAGAGAGAGGGCTATCTGAACTGCCCTGTCCTGCCTGCAGCAAGCCATAAACATTCCTTGGAGAAAGATGCTTTCCCAGCATCAAGATGAGAAGATAACTTTTATCAGCTCAGAGATGGCACCAGAGCCATCTACAAATACAAACAAACCTTGCTATCCTACTCCTTAGCTCACTTCCACATGTTTACCTTCTCACAGCTTGCCACCCCTGGAAGCCTACAACTGCATTCGTCTTGTCACCTTTCTCTTCTTTCTTTCTTTCTCTCTTTCCTTTCCTTTCTTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTTTCCTCCTTTCCCTCTTTTTTTTCCTTTTTTTTCTGAGACAGGCTAGGGTGCAGTGGCGCGACCATAGCTCTCTGCAGCCTCTAACTCCCAGACTCAATTGATCCTCCCACCTGATCCTCCTGAGTAGCTAGGACTACAGTAGCTGGGCATGCCACCATACCCAGCTAATTTATTTTCAATTTTTCTGTAGAGATTGGATCTCACTATGTTGCCCAGGCTGGTCTCGAACTCCTGGCCTCAAGCAATCTGCCCACCTCAGCCTCCCAAATTGCTGGGATTCCAGGCATGAACCACCGTGCCCAGCCATCTTGTCACTTTCTAAAATGCATTGCTCTTCATGGCAGATGCTCCATAAGCCAGAGTTCTAAGCCGCAGCATTGAGTTACTTTCACTGAGGCTTCTCCTGCGTGGTGTGCATCACAGACATTAACAAACTTGCTTTTTTTTCTCTATTATTAATCTGTCTTTTGTTACAGTGTCTTTCCCAACAAATAACTTAAGATGATTGAGGAGAAATTATATTTCCTTCCCAGCTGGCTAATTCCAAATGTGTCCTCAAGCCTGGTGCTTGGACTCAAACCCTGCCACAGGTCAAGAATGCCACACCAAGCAGACGCTGTGTTAGAGGGGCACCTGAGGTGACATGTTTGACAGATCACATAACTGAATAACTGCATTTTCTGAAGGAAAATCAACGAAGTGCTTTGAGGCCAAGTAGATGGGATTCTTGAGGATTCCATGAATAGCAAATAGTAGTATCCCCCTCAGAGGCTCTTGGGTGGGGGCATTAAATGTGTTAATACATGTGTTTGCTGCAGGTATAGCCAGAATATGTGAAAGCAGCTACAGGGAATAGAGTGTAGCAAACTCCTAATCATCCCTCAAAACCCTGCCCTGGTGTCCTCTCCCTTGTAAACTTTCCTTGAACAAGGCAGAACCAGCTACATCAGCACCATACCATCCCTCCATCACTACAGATATCACTCTGTACTATAATTATCCATTTATTTTTCTAGGCCTTGCACTCCCTAAGGCCAGGATTCTGACTCTTTCCCTGAGTGCTGTTTACCTGAACTGAACCGGCATGAACCACCACGCCCGGCCATCTTGTCACTTTCTAAAATGCATTGCTCTTCGTGGCAGATGCTCCATAAGCCAGAGCTCTAAGCCGCAGCATTGAGCCGCAGCATTGAGCTGAAGCCTGAAGGGAAGATGGCTTTGATATGTTAAAACTCATTCCAGTTTACTCCTATTTTTCATTCATTCATCCACACATTCACTCAACAAAGATCCTTGAGCTCTGATATCCATGTCTTTTTTGTGGCTCTTAGTTTATCTTTGACAAAGTTAATATATTATGCTGAATTTAACTTGGGAAAGACAAGAAGGAAATGAGTGGACAGTGGTAGCAAAGTGTTGGGACGGTGAGATCAAGGGTGACTTTTTTTCCCTTTGCTTCTCAACTTCTCCCTAATGTAGTTGTTATTTTACTTTTATGATGGAAAAATGCATATGTATGGGAATACTGTATTTCAGGCATTATAAGGAATGAAATTATAGGCCGGGCATGGTGGCTAACCCTTGTAATCCTAGCACTTTGAGAGGCTGAAGTGGGCAGATCACTTGAGCTTCAGAGTTCGAGACCAGCATGGACAACATGGTGAAACCCAGTCTCTACCAAAAACACAAAAATATTAGCTGGGTGTGGTGGTGCATGCCTGTAGTCCCAGCTACTCAGGAGGCTGAGGTGGGAGGATCGCTTGAGCCTGGGAGGCAGAAGTTGCAATGAGCAGAGATCGTGCCACTCCGCTCCAGTCTTGGTGACAGAATGAGACTCCATCTCAAAAATAAATAAATAAATAAAATAAATGAAATGAAATTATAAGAAATTACCACTTTTTCATGTAAGAAGTGATCATTTCCATTATAAGGGAAGGAATTTAATCCTACCTGCCATTCCACCAAAGCTTACCTAGTGCTAAAGGATGAGGTGTTAGTAAGACCAACATCTCAGAGGCCTCTCTGTGCCAATAGCCTTCCTTCCTTTCCCTTCCAAAAACCTCAAGTGACTAGTTCAGAGGCCTGTCTGGAATAATGGCATCATCTAATATCACTGGCCTTCTGGAACCTGGGCATTTTCCAGTGTGTTCCATACTGTCAATATTCCCCCAGCTTCCTGGACTCCTGTCACAAGCTGGAAAAGTGAGAGGATGGACAGGGATTAACCAGAGAGCTCCCTGCTGAGGAAAAAATCTCCCAGATGCTGAAAGTGAGGCCATGTGGCTTGGCCAAATAAAACCTGGCTCCGTGGTGCCTCTATCTTAGCAGCCACCCTGCTGATGAACTGCCACCTTGGACTTGGGACCAGAAAGAGGTGGGTTGGGTGAAGAGGCACCACACAGAGTGATGTAACAGCAAGATCAGGTCACCCACAGGCCCTGGCAGTCACAGTCATAAATTAGCTAACTGTACACAAGCTGGGGACACTCCCTTTGGAAACCAAAAAAAAAAAAAAAAAAAAGAGACCTTTATGCAAAAACAACTCTCTGGATGGCATGGGGTGAGTATAAATACTTCTTGGCTGCCAGTGTGTTCATAACTTTGTAGCGAGTCGAAAACTGAGGCTCCGGCCGCAGAGAACTCAGCCTCATTCCTGCTTTAAAATCTCTCGGCCACCTTTGATGAGGGGACTGGGCAGTTCTAGACAGTCCCGAAGTTCTCAAGGCACAGGTCTCTTCCTGGTTTGACTGTCCTTACCCCGGGGAGGCAGTGCAGCCAGCTGCAAGGTGAGTTGCCTTCATTTCTGGGGAAGCGGCTGTTTTGAGAGGGTTTTGTTTCTTCCTCTTTGAGAAGGCTCAGAAAATTGTGGGAATTTTCTGCCTACAGAGAGAAGGTGTTGGAAAGTCTAGGTAAAAAAATGCCGACATGAGGTTTGGTCATTTGAACATGGCATCTTGGTCAGATTTCTTTTCTGCAAATATTAGCTGTGGTTGTTACATGACAAGGAAAAACTTTCTGAAAAGTTCAAAATGGGAGTTTGTATCTGCTAAGAATTTTTTTTAACAGAGATTATCTTATCAGTCCTTATAACATGTAACCTCCCCACAAATCCTGGTAAGATGGATATATTAAACCCATTTTATGGATGAATAAATGAGTTTCAGTTAAATAACTTGATCCAGGACACATAACTGGTAGAGCTAGGATTCCAGGATTTGAACCCAGGTCTATGGGGCTATAAGTTCTTTTCTTTCTTTCCCTCTTTCCTTCCTTTCCTTCCTGTCCTTTCCTCCCTTCCCCTCCCTTCCCTTCCCTTTCTTTCTTTTTTTTTTTTGGAAACAGCCTTGACTGCCCAGCCTCAAGCAATCCTTCTGCCTCAGCCTCCCGAGTAGCTGGGACTACAGGCACAAGACACCATGCCTGCCTGGCTAATTTTTCAATTTTTTGTAGTCAAGGTCTCCCTATGTTGCCCAGGCTGAACTCGAACTCTTGGACTCAAGCGATCCTCCTGCCTCGGTCTCCCGAAATGCTGGGATTACAGGCGTGAGCCACTGCACTTGGCCTAAAATTCTTACATGGACTATATTCACTACACTGTCTTCTAAAGACAGAGTTTTTGCCTCTTTGATCTTCCTCTTGTCTGTTTCAAAGGAGATGATCTCAGATTTCGAGGGATGAGTGCATTTTTCACAAATATTTCCTCCCCACATAATAAAAGAGGAGCAAGTAATAATGCTGAGTTAGAACAACAACTGCAAAATCTTTAAAAGAAAGGTAGCTACAGCTTGAGTGCTTTCCCCAGTAATAGACCTAAAACTACAGTTGATAATGAGAGCTGCTGGGAAGTGTCTTTCAGGGTCAGGCAAAGGCACCCCTGTTTCAACGACCTCCGGGCTCTTCCTCACCCTGCCTGTGGCCAGTGATGAAGCCTGGCTGGGTCTGGTGGGCCAGCAGGTCCCGCTAAGGAGGCTCATGGTGCATACAGTTTGTCCTTGTTAAGTGGCGATGGGGATGGGGGGGTTCATTGTTTTTCCTTAAGATTATTAGGTGGCTTTACAGAATTGAAGTCTGTGTCCGAAGGCTCCCCATTCCAACCCCGAAATAGAGACAGAGGTTGCAAAGCATTGATGAAGGGGCTCATGCTGGCGTTCATATCGATTCCCCAGTGAGCCAACCCCACTGAGAAGCCCTGTTCTGTAAACTCTTCTTCAACCTTCCCTCACCTCTGCTTCCCTTCTTCAGCCCCACAGTGAAGAACATCTGAGCTCAAATCCAGATAAGTGACATAAGTGACCTGCTTTGTAAAGCCATAGAGATGGCCTGTCCTTGGAAATTTCTGTTCAAGACCAAATTCCACCAGTATGCAATGAATGGGGAAAAAGACATCAACAACAATGTGGAGAAAGCCCCCTGTGCCACCTCCAGGTGAGTTTTCCCTGGGGGAACCTCCTGCTTGTCTCCTTGGGCACCCATGCCCTGTCGGCACCGATGACTCAGAATTCCTCTCTCTGCTCCTCCTCTCTCACCTGAGGTCTGATCTCCTCATTGCTTCTTGAAAGTCCCTGTTGGAATTCAATGCAGCCGCTGATTATTGGGCACCTCGCTGTGCCTGACGGTATGTGAAGAAGGAAGGGACATGGTGCGGGGCTGGCCCTGAAGAAGCTTGGAATCTTTGGGGAAGAATATGGGAAGGAGCTTGGCCTGAGAATGGGAGGCAGTAGAGCCTCGTGGTGGGCACCATGGCGGAGGGGTGGGGGTGGAGGGTCAGCATCCTGGCCTGCGTCCATTCCAATTCACCGCTTGCTAGATGCTTTGAATATCATCCTGGTGAAGGGCATCAGGATGTTAGACAAACTAGTTCCAAGCCCTGTGCTGGCCGCACTAGTTGCCGGGTGCTGCCTCTAGCCAGCTGTGTGACGCAGGGTAAGTTAACCTCTCTGAAACTTAGTGCTCACCTGTGGTATGAGGAACCCAAGGGGGCCCTCACCATAGTGTGCTGAGGATGAAATGAGATCTACAGCACTCAGCACTGTGCCCACACAGAACAGACACTTAGTCCACATCAGGGTTCATCACCATCTACTGAGTACCTGCCCTTGCCAGAGCTACACAGGCCACTTGACAGACTTTGCATCTCAACTGATCTCTGTGGCGGCTCTTTGAAGTTCATATGATTGACTCATTTCACAGATAAGGAAATAGAAGCTCTAATAGGATTATGACTTCCCCCAGCCTGAATGACCGGTAATTACAGAGTTTACAGAGTTGGAACTTGAGCCCAGATTTGGATTCTTCATGTCCCTCCTCCCCGGGCCCATCCTTCCTCCCAGGGCAGAACCAAGAGAATGAGTCAGTTAATGAACAAGTCAAGGGACAGGCTTGAGGCTCGCTCAGGTGGAAAGACAAAGCAATCTGCAATAACGCAATAGTGCAACTGAAACCAAAGCCCCCATCTACACAAGACCACCACATAGCCACACAACCCCACCGCCCCAGAGGAGCCTTTCCCATGGACTACAAAGGGTAGGGCGCCCCCTGGATGTGTACAGCATGACGGCCCTGAGTGTATCTGTCAGAGGCGGCAAAAAATGCCAGTG"
                           "\n>GBA1 | Homo sapiens | NC_000001.11 | Promoter | TSS (on chromosome): 155244626 | TSS (on sequence): 3000\n"
                           "CTGCTTGCCTCTGCTGCTCTGGACTGGGAGAGCTTCTGTCCTGTGCTGCATGGGTATTTAGACTGTGGGGGAGATGCCCCTTCTTATAGCACTGGAGGAGGAAAACAAATTCTTGTCCCCCTCAGAATGAGAGTGGCTCTTTCTGATTTGCAAGGGCACTATGGTCAGGGCAAAGGCATGGCCCAGGTGTTTAAGTACAGGGTGACGTGTGCCTATGCAATGGGGTGGTAAGGCAGGCACGAAGAGTCCAAAAAATCTAGGTGGCCTCTCAGCTCTGCCACCTCTAGCTGCATGACCTTGGGCAAGCTATGTAACCCCAATTGCCTGCTCCATTAAAGACTGTGAAGGTAGAATGTTTGTAAAGCTCTTAACAGTATGTAAGCCTTCAATAAATTTCAGTTTTCCCCTTGTTTTCTTGATCATTCTCTGTCACCAGTGAAATTTGTTCTAGTGTCTCTCATATTTAAGAAAACTCTTTCAGGACTGGGTATGGTGGCTCACACCTATAATCCTAGCACTTTGGGAGGCCGAAGCAAGAGGATCGCCTGAGCCTAGGAATTCAAGACCAGCCTGGGCAACATAGTGAGACCCTGTCTCTACAAAAAACAAAAAATTAGCCAGGCATGGTGGGACACGCCTGTAGTCCCAACTACTCAGGTGGCTAAGGTGAGAGGATCACTTGAGCTTGGGAAGTCCAGGCTGCAGTAAGCTGTGATTGAGCCACTGCACTACAGCCTGGGCAACAGAGCAAGACCATGTCTCAAAAAAAAAAAAAAAAGAAAAAAGAAACTTTCAAGACACTCTTTCCAACCACTAATTGTAACTCTGCTCCTCCTTTTCACAGCAATAGGTTTTCTTTTTCTTCCCTCCACTGTTAAACATCCATTCTCTCCTCACCCACCCCCATCAGACTCCTTCCCCTATCTTTCCACAGCCACTGCTCTGACCAAACTTTCCAGTGACCACAGTGGTGTCAGACCCAGTGACCATTTCTCTGCCTGCATCTCACTTGACCTCGAGGCAGCAATTAATACCCATAATCAGCATCTTCTTGAATTTGTCCCTTTGAAAAGGGAAATATTGGCTCTTCTACTTTGTCCTGCTGAACTGCTTAACATTGGAGGGCCCCAGGGCCCTCACCTAAGCCCTCTTTCCTACCTCCACTCTTTCTATAGGTGGCCCTACTACTAAAGTCCATGGCTTTAAATACCATCTTTCTATGTGTTAATCCATAACTCCAGCCTTGACCTCCCATGAGCGCCATCCAACTCAGCATGTCTGCTTGGATGTCTAATGGGCATTTCAGATTCAACATGGCCACAACTGAACTCTTGATTCCCACCCCAGCACCGGTTATTTTTCCACTGTTCCCATCTCAATGGCACCTCCATTACCCATTTGCACATTCCAAAAGCTCAGGAACCATGGTGACTTCTTTTCCCATATCCAACACAACCAATCCTATCCTGAATTCATCCACATCCCACCACCTCCCCAGCTACCTAGCTCCAGCCATCCTCTCTCCACAACCTCTGAATCAGTCTTTCACTTTTCCCAGCAATCCATTCTCCACTCAGCAAAATGATGATAAAGCACGTCACATCAAGGCTCTGCCTCAATTTAATGGCTTCCCATTGTATTTAGAATCATCTCCAAACTCCCAGAGACTATGGTCAGCTACAATCTGGCCCACCTTCTGTTCCAGCCAAATTTCCTCACAGCACAAGGACGTTTGCACCTGCTGTTTTCCAAGCATGAAACCCTTGGCCCCTATATCTGGTGCTATCACCTAATATCAGGTTTTAGCTCCATTCTCACCATTTCAGTGAGCACCCAATCCCCATCGCAGTCATTCTATCACATAGCCATGTTTTTTTTTGTTTGTTTGTTTCATTTTGTCTTTTTTTGAGACAGGGTCTTGCTTTGTTACCCAGGCTGGAGTGCAGTGGTGTGATTTGGGCTCACTGCAACCTTCCACCTCCTGGGTTCAAGCAATTCTCCTGCCTCAGCCTCCCGAGTAGCTGGGATTACAGGCGCCCGTCCCCATGCCCGCCCAGCTAAATTTTGTATTTTTAGAAGAGATAGGGTTTCACCATGTTGGCCAGGCGGGTCTCAAACTCCTGACCTCAAGTAATCCGCCTGCCTCGGTCTCCCAAAGTGCTGGGATTACAGGTGTGACTCACCGCGCCTGGCCACATACCCATGGTTTCAGCATGTATCACTATCTAAAATTATTATTTTTGTTTATATATCTGTGTCGTCCCATAGAATGTTAAGGTCCCAAGATCAGAAACTTGCTCATTGCAGTGGGTCTAACACTCAGTAGGTCCTCAACAAACATTCGTTAAGATACTAAAGTGGCAGGGTGGGGCCCTGTAAACAGCTTCAGGACCCTGTGCTTGTAGGGGCAACGTGGTGCCCTCCAAGGAAGACAGGGAGGTGGGAGGAGCACTGCCCAGAGATGGCGTCAGGCTGCAAGACTTCTTGAATAATTCAGCATCATAACAACCCAGCCTCAGGAAGGGATAGGGCACGGCCAGGACGAAACATTAGGAGGCGATGGACAATGGGATTCCCACGGGGCAGCTTCTGCGCACTGGACGTTCCCTAACCTGAGGCTCTCTAAAGAGGAAGGTTAGGAATCCTCTGAGCTTCGGTGGGCTGGACTCACTGTGGGAATTCAATCGCCCCCATCCACCAACAGTGTGCTGGCGGGAAAACGCCGACACGCATGCGTAGTTCTCGCGCCGGCTCCTCTCTCTCTCTCTCTCTCTCTCGCTCGCTCTCTCGCTCTCTCGCTCTCTCTCGCTCGCTCTCTCGCTCTCGCTCTCTCTCTCTCTCCGGCTCGCCAGCGACACTTGTTCGTTCAACTTGACCAATGAGACTTGAGGAAGGGCTCTGAGTCCCGCCTCTGCATGAGTGACCGTCTCTTTTCCAATCCAGGTCCCGCCCCGACTCCCCAGGGCTGCTTTTCTCGCGGCTGCGGGTGGTCGGGCTGCATCCTGCCTTCAGAGTCTTACTGCGCGGGGCCCCAGTCTCCAGTCCCGCCCAGGCGCCTTTGCAGGCTGCGGTGGGATTTCGTTTTGCCTCCGGTTGGGGCTGCTGTTTCTCTTCGCCGACGGTAGGCGTAATGAATATTTCGACCTTTGGATCTTAGCTGTCCCCTCCCTGCGTTCGCACTTAACCTTTTTCACCATTATTATTATTATTGTTATTATTATTATTTTTTGAGGGAGTCTCGCCCTGTCGCCCAGGCTGGAGTGTAATGGCGCCTTCTTGGCTCACTGCAACCTCCGCCTCCCGGGTTCAGGCGATTCTCCGACCTCAGCCTCCCAAGTACGTGGGATTACAGGCACCCGCCACCACGCACGGCTAATTTTTTGTATCTTTTAGTAGAGACGGGGTTTCACCATGTTGGTCAGGCTGGTCTCCAATTCCTGACCTCGTGATCCGCCCGCCTCGGCCTGCCAAACAGCTGTGATTATAGGCGTGAGCCACCGCGCCCGGCCAACCATCATTATTATTTTTAACGGTAAGGATGGTCAGATTTTACTAATGAAGAAGAGATTATAAAATCTTCAAGTCTTTATATCCACTTGCTTTTTGAGGGGTGGAGTGGGAAGAAGGTTATGTAATTCATACGTTCTTCAGACATGTGACAAACATTCACGGAGCCCGGCGACGAGCGTCGGGGTTGGGATTCGCACTGGAGCTGCAGATGGGTGCCAGGATGGACTGGTCCCTACCCTCCGCTTGAACCTAGGAGGCGGAGGTTGCAGTGAACCGAGATCGTGCCACTGCACTCCAGCCTGGGTGACAGAGATACTCCGTCTCAAAAAAAAAAACAAAACAAAAAACAAGCGGACTGGGCGCAGTGCCTCACCCTGTAATCCCAGCACTTTGCAAAGCCAAGGCGGGAGGATCCTTTGAGTTTAGGAGTTTGAGACCAACCTGCGCAACACAGTAAGACCCCGTCTCTACAAAAAATACAGAAATTAGCCAGGTGTGGTGGTGTGCGCCTATAGTCCCAGCTATTCTGGAGGCTGAGGTGGGAGGATTGCTTATTCTGGAGGCAGAGGTTGCACTGAGCCGAAATCAAGCTACTACACTCCATCCAGGGCAACATACGGAGACCCTGTCTCAAACAAACAAACAAAAAATTGCTCAGTACCTGGCCAAAAAAGAAGAGGCTCACTATGCAGAGGGGAAGTGGAAGGAGATGTTTGGACTTCTAAACTCAATAGAGCAGGAGAGGCAAATGTAGAATGTGCTCAGGAAATATCTGTGAGATGAATGAACTTGAGGGAAGTAAGGTACTAGATATTACCTGCCCTACCCAGAACAAATCCTGTGCAATGTTTCCTTGAAAAGTGAGAAGTCTGGAAGGGGTGGCTACTGACATAGTGAAGCAACTAGTTCAATTCTACAACTTGACAGCTACCCCTGTGCCAGGCTATCTACGAGGATACTTAGAATGCATAAGACATTCCTTCAAGGAACTCCAGGAACAGAGGCCTGACATGTTGCAATGTTTAGTGTCAAGCAGTGTACTAGAGACACATTATCACACTCAAACCTCACAACAATTCTGTGAGGTAGGAGTTATCACTCCCCTTTTATAGATGAAACAGAGGCTTAGAGTGATTGATTTATTGAAAGTCAAACAGCCAGTAAATGGTGTAGCCAGGATTCCAAACTTGCTGTCTCACTGAGACTGTACTTAATTACTGGAGGGACCGGGTGTGGTGGCTCATTGCTATAATCCCAACACCTTGGGAGGCTGAGGCTGGTGGATCACCTGAGGTCAGGGGTTCGAGACCAGCCTGGCCAACATGGTGAAACCCCATCTCTACTAAAAATACAAAAATTAGCTGGGCATGGTGGTGGGCTCCTGTAATCCCAGCTACTCAGGAGGCTGAGGCAGGGCAATTGCTTGAGCCGAGATCACACTGCACTCCAGCCTGGGCAACAGGGCAAGACTCTGTCTCAAAACCAAAAAAAAAAAAATTACTGGAGGAACCTAGAAGAAGAAATGATCAATTTTGCTTGGAGTGTATCTAGAAAGACTTCACTGAGATCATTTAAAGAACAAAAAGGATGGCTGGGGTCCAGCGCAGTGGCTCATGCCTGTAATCCCAGCACTTTCGGATACCAAGGCAGCAGATCACCTGAGGTCCAGAGTTTCAGACCAGCCTGGCCAACATAGTGAAACCCCATCTCTACTAAAAATAAAAAAATTAGCTGAGCATGTTGGAGGGCACCTGTAATCCCAGCTACTTGGGAGGCTGAGGCAGGAGAATCACTCGAACCCAGGAGGTGGAGGTTGCAGTGAGCCAAGATCACGCCACTGCACTCCAGCCTGGGCAACAGAGTGAGACTCTGTCTCAAAAAACAACAACAACAAAAAATACAAACAAGAGACAAGTAGTTCCCAGGTGCCTACCAAGTGGTCAGGCACTGCACTTACCTCACTGACTGCAGTAACCACCCTTTGAGGTTGTGGCATTGCCTCCATTTTCCAGGCAAGGAAATGGGCTGAGAGCTGGGATTAGTCAGGTCATGACTGTGTGTGCCACTCCCGCTAAATCTCATTTGATGTGGTTCATGAGGCCACACCATGGACAGCTTCCTCCTTGTGTCCACTGAGGATATGGCTTTGTACAACACTTTGGTTTTTGAACGACTTTACAAACCTCCCTGTCTTGTGAGGAAGGAAGAACAGTTATTACCATCTGCATCTGATGATGAAACAAGGGACGCTGCAGAGGAGCCGCACTGACCACTCCCTCCCTCCAGTCCTGTCATCCCACTGCCAGTGTCCCACCCTCTTGTGCCCTGCACTTCACTGGCTAATAACCCCCCTCACTTTTTCCTCTGTGAAGCCATCCTGGATAATTCCCCACCCACGAATGGTCCCTCCTCATCTCAGAGAGCTCTCCATGCACACCTGTTACCGTTTCTGTCTTTATCTGTAAATATCTGTGTGTCTGACTTCCATGCC")

# Définir les couleurs des bases
base_color = {
    "C": "yellow",
    "G": "green",
    "A": "red",
    "T": "blue",
    "U": "cyan",
    "N": "black",
    "Other": "white"
}

# Lire les séquences FASTA
if fasta_input:
    fasta_io = StringIO(fasta_input)
    sequences = list(SeqIO.parse(fasta_io, "fasta"))

    # Configuration du slider pour la résolution
    resolution = st.slider("Resolution", step=1, value=20, min_value=1, max_value=1000)

    # Créer un graphique pour chaque séquence
    for seq_record in sequences:
        st.subheader(f"Graphique pour {seq_record.id}")

        # Calcul des fréquences
        frequencies = calculate_frequencies(str(seq_record.seq), resolution)

        # Création du graphique avec Altair
        chart = alt.Chart(frequencies).mark_area().encode(
            x=alt.X('position:Q', axis=alt.Axis(title='Position')),
            y=alt.Y('frequency:Q', stack='zero', axis=alt.Axis(title='Fréquence des nucléotides')),
            color=alt.Color('base:N', scale=alt.Scale(domain=list(base_color.keys()), range=list(base_color.values()))),
            order=alt.Order('base:N')
        ).properties(
            width=800,
            height=400,
            title=f"Fréquence des Nucléotides pour {seq_record.id}"
        )

        # Affichage du graphique dans Streamlit
        st.altair_chart(chart, use_container_width=True)
